$fontUrls = @(
  "https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf",
  "https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf",
  "https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf",
  "https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf"
)

$fontTargetDir = "$env:LOCALAPPDATA\Microsoft\Windows\Fonts"
New-Item -ItemType Directory -Force -Path $fontTargetDir | Out-Null

foreach ($url in $fontUrls) {
    $fileName = [System.IO.Path]::GetFileName($url)
    $destPath = Join-Path $fontTargetDir $fileName

    Write-Host "ğŸ“¥ æ­£åœ¨ä¸‹è½½ $fileName..."
    Invoke-WebRequest -Uri $url -OutFile $destPath

    # æ³¨å†Œå­—ä½“ï¼ˆä»…å½“å‰ç”¨æˆ·ï¼Œä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
    $fontName = $fileName -replace ".ttf$", ""
    New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Fonts" `
        -Name "$fontName (TrueType)" -PropertyType String -Value $fileName -Force | Out-Null
}

Write-Host "`nâœ… æ‰€æœ‰å­—ä½“å®‰è£…å®Œæˆï¼Œè¯·é‡æ–°å¯åŠ¨ç¨‹åºåç”Ÿæ•ˆï¼ˆå¦‚ Windows Terminalï¼‰"
